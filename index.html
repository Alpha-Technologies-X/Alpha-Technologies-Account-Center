<script src="https://cdn.auth0.com/js/auth0-spa-js/2.0/auth0-spa-js.production.js"></script>

<script>
(async () => {
  const auth0 = await createAuth0Client({
    domain: "alphatechnologies.us.auth0.com",  // âœ… NO https://
    clientId: "q5h7SCxVv8kK5TPLDHzBMkcFkjatro1i",
    authorizationParams: {
      redirect_uri: window.location.origin
    }
  });

  if (window.location.search.includes("code=")) {
    await auth0.handleRedirectCallback();
    window.history.replaceState({}, document.title, "/");
  }

  const loggedIn = await auth0.isAuthenticated();

  if (!loggedIn) {
    await auth0.loginWithRedirect();
    return;
  }

  const user = await auth0.getUser();

  document.getElementById("avatar").src = user.picture;
  document.getElementById("name").textContent = user.name || "Alpha User";
  document.getElementById("email").textContent = user.email;

  document.getElementById("account").style.display = "block";

  window.logout = async () => {
    await auth0.logout({
      logoutParams: {
        returnTo: window.location.origin
      }
    });
  };
})();
</script>
